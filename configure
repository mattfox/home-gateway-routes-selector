#!/bin/sh
ROUTESAPP_DEPENDENCIES="python-netaddr"
apt-get install $ROUTESAPP_DEPENDENCIES

ln -fs `pwd`/nginx /etc/nginx/sites-available/routes
ln -fs /etc/nginx/sites-available/routes /etc/nginx/sites-enabled/routes
rm -rf /usr/local/share/routes/
mkdir -p /usr/local/share/routes/
cp -r static /usr/local/share/routes/static
cp -r node /usr/local/share/routes/node
cp -r bin /usr/local/share/routes/bin

# Use visudo to add the following to the end of /etc/sudoers. This allows
# the www-data user (the node process) to run the routesrules script
# as root without providing a password.
# www-data ALL=(ALL) NOPASSWD: /usr/local/share/routes/bin/routesrules

# Install NodeJS, as per https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager
# curl -sL https://deb.nodesource.com/setup | sudo bash -
# apt-get install -y nodejs

